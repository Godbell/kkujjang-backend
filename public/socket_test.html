<!doctype html>
<html>
  <head>
    <title>끝말잇기의 짱, 끝짱</title>
  </head>
  <body>
    <button id="disconnect" onclick="socket.disconnect()"></button>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      /**
       * @param {{
       *   roomOwnerUserId: number;
       *   title: string;
       *   password: string;
       *   maxUserCount: number;
       *   maxRound: number;
       *   roundTimeLimit: number;
       * }} roomConfig
       * @returns {string}
       */
      const roomConfig = {
        title: '방제목',
        password: '1234',
        maxUserCount: 4,
        maxRound: 3,
        roundTimeLimit: 5,
      }

      const socket = io('http://localhost:3000')

      socket.on('complete load room list', (res) => {
        console.log(`load room list: ${JSON.stringify(res)}`)
      })

      socket.on('complete create room', () => {
        console.log(`create room`)
        socket.emit('load room list')
      })

      socket.on('some user join room', (userId) => {
        console.log(`some user join room: ${userId}`)
        socket.emit('load room')
      })

      socket.on('some user leave room', (userId) => {
        console.log(`some user leave room: ${userId}`)
        socket.emit('load room')
      })

      socket.on('complete leave room', () => {
        console.log('complete leave room')
      })

      socket.on('complete load room', (res) => {
        console.log(`load room: ${JSON.stringify(res)}`)
      })

      socket.on('complete join room', (res) => {
        socket.emit('load room')
        socket.emit('switch ready state', true)
      })

      socket.on('complete switch ready state', (res) => {
        console.log(`complete switch ready state: ${JSON.stringify(res)}`)
        socket.emit('start game')
      })

      socket.on('complete start game', (game) => {
        console.log(`game start: ${JSON.stringify(game)}`)
        socket.emit('round start')
      })

      socket.on('complete start round', (roundWord) => {
        console.log(`round start: ${JSON.stringify(roundWord)}`)
        socket.emit('turn start')
      })

      socket.on('complete start turn', (turnObj) => {
        console.log(`turn start: ${JSON.stringify(turnObj)}`)

        setTimeout(() => socket.emit('chat', '단어'), 1000)
      })

      socket.on('complete round end', (roundObj) => {
        console.log(`round end: ${JSON.stringify(roundObj)}`)
        socket.emit('round start')
      })

      socket.on('timer', (timeObj) => {
        console.log(`timer: ${JSON.stringify(timeObj)}`)
      })

      socket.on('error', (msg) => {
        console.log(`error: ${msg}`)
      })

      socket.on('chat', (msg) => {
        console.log(`chat: ${JSON.stringify(msg)}`)
      })

      socket.on('say word', (res) => {
        console.log(`say word: ${JSON.stringify(res)}`)
        socket.emit('turn start')
      })

      socket.on('game end', (res) => {
        console.log(`game end, ranking: ${JSON.stringify(res)}`)
        socket.disconnect()
      })

      socket.on('change room owner', (res) => {
        socket.emit('load room')
      })

      socket.on('error', (err) => {
        console.log(`error: ${JSON.stringify(err)}`)
      })

      socket.emit('game start')

      socket.emit('load room list')
      socket.emit('create room', roomConfig)
    </script>
  </body>
</html>
